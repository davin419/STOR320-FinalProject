---
title: "R Notebook"
output: html_notebook
---

```{r}
library(readr)
library(tidyverse)
library(gridExtra)
```

```{r}
CBB = read_csv("cbb.csv")
names(CBB)
CBB <- CBB %>% 
  rename(School=TEAM) %>% 
  rename(Conference=CONF) %>% 
  rename(GamesPlayed = G) %>% 
  rename(GamesWon = W) %>% 
  rename(AdjustedOffensiveEfficiency=ADJOE) %>% 
  rename(AdjustedDefensiveEfficiency=ADJDE) %>% 
  rename(PowerRating = BARTHAG) %>% 
  rename(EffectiveFieldGoalPercentageShot=EFG_O) %>% 
  rename(EffectiveFieldGoalPercentageAllowed=EFG_D) %>% 
  rename(TurnoverRate=TOR) %>% 
  rename(StealRate=TORD) %>% 
  rename(OffensiveReboundRate=ORB) %>% 
  rename(OffensiveReboundRateAllowed=DRB) %>% 
  rename(FreeThrowRate=FTR) %>%
  rename(FreeThrowRateAllowed = FTRD) %>% 
  rename(TwoPointShootingPercentage = "2P_O") %>% 
  rename(TwoPointShootingPercentageAllowed='2P_D') %>% 
  rename(ThreePointShootingPercentage='3P_O') %>% 
  rename(ThreePointShootingPercentageAllowed='3P_D') %>% 
  rename(AdjustedTempo=ADJ_T) %>% 
  rename(WinsAboveBubble=WAB) %>% 
  rename(Postseason=POSTSEASON) %>% 
  rename(Seed=SEED) %>% 
  rename(Season=YEAR)

```

```{r}

q3<- ggplot(data=CBB) +
  geom_point(aes(x=TurnoverRate,y=GamesWon)) +
  geom_smooth(aes(x=TurnoverRate,y=GamesWon)) + 
  xlab("Turnover Rate")+ylab("Games Won")

q3
```

```{r}

q4<-ggplot(data=filter(CBB,Conference=="ACC")) +
  geom_point(aes(x=PowerRating,y= GamesWon/GamesPlayed))+
  geom_smooth(aes(x=PowerRating,y= GamesWon/GamesPlayed))+
  ggtitle("Power Rating Efficiency in the ACC")+
  xlab("Power Rating") +ylab("Average Win")

q4
```

```{r}
#Plots for q7
q7plot.1 = ggplot(data=CBB, aes(x=AdjustedOffensiveEfficiency, y=PowerRating)) +
  geom_point()

q8plot.2 = ggplot(data=CBB, aes(x=AdjustedDefensiveEfficiency, y=PowerRating)) +
  geom_point()

grid.arrange(q7plot.1, q8plot.2, ncol=2)
```

```{r}
#Plot for q8
q8plot.1 = CBB %>%
  group_by(Conference) %>%
  summarise(Count = n(), GamesWonAvg = mean(GamesWon)) %>%
  arrange(desc(Count)) %>%
  ggplot(aes(x=Conference, y=GamesWonAvg)) +
    geom_bar(stat='identity')

q8plot.1
```
```{r}

q3<- ggplot(data=CBB) +
  geom_point(aes(x=TurnoverRate,y=GamesWon)) +
  geom_smooth(aes(x=TurnoverRate,y=GamesWon)) + 
  xlab("Turnover Rate")+ylab("Games Won")

q3
```

```{r}

q4<-ggplot(data=filter(CBB,Conference=="ACC")) +
  geom_point(aes(x=PowerRating,y= GamesWon/GamesPlayed))+
  geom_smooth(aes(x=PowerRating,y= GamesWon/GamesPlayed))+
  ggtitle("Power Rating Efficiency in the ACC")+
  xlab("Power Rating") +ylab("Average Win")

q4
```
